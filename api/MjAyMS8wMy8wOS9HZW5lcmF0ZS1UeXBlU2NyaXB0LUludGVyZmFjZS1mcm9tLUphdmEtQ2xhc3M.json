{"title":"Generate TypeScript Interface from Java Class","date":"2021-03-09T14:16:55.000Z","date_formatted":{"ll":"Mar 9, 2021","L":"03/09/2021","MM-DD":"03-09"},"link":"2021/03/09/Generate-TypeScript-Interface-from-Java-Class","tags":["Java","TypeScript"],"updated":"2021-03-10T14:44:02.498Z","content":"<p>æœ€è¿‘åœ¨å¯¹ Web é¡¹ç›®åšæ¶æ„å‡çº§ï¼Œè®¡åˆ’ä½¿ç”¨ TypeScript ã€‚</p>\n<p><strong>ä¸ºäº† NO AnyScript !!!</strong></p>\n<p>å› æ­¤éœ€è¦å¯¹å·²æœ‰çš„ Java Web åº”ç”¨æ¥å£çš„ Model Class ç”Ÿæˆå¯¹åº”çš„ TypeScript Interface ã€‚</p>\n<p>ä¸ºäº†ä¸å‡å°‘æ‘¸é±¼æ—¶é—´ï¼Œå½“ç„¶æ˜¯å†™ä¸ªè„šæœ¬ç”Ÿæˆ ğŸ¶</p>\n<h1 id=\"å…·ä½“æ€è·¯\">å…·ä½“æ€è·¯<a title=\"#å…·ä½“æ€è·¯\" href=\"#å…·ä½“æ€è·¯\"></a></h1>\n<ol>\n<li>\n<p>ç»´æŠ¤ä¸€ä¸ª Java ç±»å‹æ˜ å°„åˆ° TypeScript ç±»å‹çš„ Map</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Map&lt;String, String&gt; javaToTypeScriptTypeMap = <span class=\"keyword\">new</span> HashMap&lt;String, String&gt;() &#123;&#123;</span><br><span class=\"line\">    put(<span class=\"string\">&quot;int&quot;</span>, <span class=\"string\">&quot;number&quot;</span>);</span><br><span class=\"line\">    put(<span class=\"string\">&quot;java.lang.Integer&quot;</span>, <span class=\"string\">&quot;number&quot;</span>);</span><br><span class=\"line\">    put(<span class=\"string\">&quot;java.util.List&quot;</span>, <span class=\"string\">&quot;Array&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>æ ¹æ®åŒ…åæ‰«æè·å–æ‰€æœ‰çš„ Class</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> List&lt;Class&gt; <span class=\"title\">getClassListFromPackage</span><span class=\"params\">(String packageName)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// è·å–è·¯å¾„</span></span><br><span class=\"line\">    String packageDirName = packageName.replace(<span class=\"string\">&#x27;.&#x27;</span>, <span class=\"string\">&#x27;/&#x27;</span>);</span><br><span class=\"line\">    Thread.currentThread().getContextClassLoader().getResources(packageDirName);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æ ¹æ®è·¯å¾„æ‰«ææ–‡ä»¶å¹¶è·å– Class</span></span><br><span class=\"line\">    String className = file.getName();</span><br><span class=\"line\">    Thread.currentThread().getContextClassLoader().loadClass(packageName + <span class=\"string\">&quot;.&quot;</span> + className);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>éå†è·å–åˆ°çš„æ¯ä¸ª Class é‡Œçš„æ‰€æœ‰ Field çš„ç±»å‹å’Œåç§°ï¼Œå¹¶æ”¶é›†æˆä¸€ä¸ª Map</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ç¬¬ä¸€å±‚ Map key ä¸º className</span></span><br><span class=\"line\"><span class=\"comment\"> * ç¬¬äºŒå±‚ Map key ä¸º TypeScript type , value ä¸ºå¯¹åº”ç±»å‹çš„å­—æ®µå list</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; res = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// foreach classList</span></span><br><span class=\"line\">Field[] fields = clazz.getDeclaredFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// foreach fields</span></span><br><span class=\"line\">String fieldName = field.getName();</span><br><span class=\"line\">String fieldType = field.getType().getName();</span><br><span class=\"line\">String tsFieldType = javaToTypeScriptTypeMap.getOrDefault(fieldType, fieldType);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¯¹äº array å’Œ map çš„èŒƒå‹å‚æ•°éœ€è¦ç‰¹æ®Šå¤„ç†</span></span><br><span class=\"line\"><span class=\"comment\">// foreach ((ParameterizedType) field.getGenericType()).getActualTypeArguments()</span></span><br><span class=\"line\">t = t.replaceAll(<span class=\"string\">&quot;class &quot;</span>, <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">t = t.replaceAll(packageName + <span class=\"string\">&quot;.&quot;</span>, <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">// foreach javaToTypeScriptTypeMap.entrySet()</span></span><br><span class=\"line\">String k = entry.getKey();</span><br><span class=\"line\">String v = entry.getValue();</span><br><span class=\"line\">t = t.replace(k, v);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>éå†æ”¶é›†çš„ Map ç”Ÿæˆ ts æ–‡ä»¶</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">StringBuilder typeFile = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">res.forEach((ck, cv) -&gt; &#123;</span><br><span class=\"line\">    typeFile.append(<span class=\"string\">&quot;export class &quot;</span>);</span><br><span class=\"line\">    typeFile.append(ck);</span><br><span class=\"line\">    typeFile.append(<span class=\"string\">&quot; &#123;\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    cv.forEach((fk, fv) -&gt; fv.forEach(field -&gt; &#123;</span><br><span class=\"line\">        typeFile.append(<span class=\"string\">&quot;  &quot;</span>);</span><br><span class=\"line\">        typeFile.append(field);</span><br><span class=\"line\">        typeFile.append(<span class=\"string\">&quot;!: &quot;</span>);</span><br><span class=\"line\">        typeFile.append(fk);</span><br><span class=\"line\">        typeFile.append(<span class=\"string\">&quot;;\\n&quot;</span>);</span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\"></span><br><span class=\"line\">    typeFile.append(<span class=\"string\">&quot;&#125;\\n\\n&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    BufferedWriter out = <span class=\"keyword\">new</span> BufferedWriter(<span class=\"keyword\">new</span> FileWriter(packageName + <span class=\"string\">&quot;.ts&quot;</span>));</span><br><span class=\"line\">    out.write(typeFile.toString());</span><br><span class=\"line\">    out.close();</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>æœ€åå¾—åˆ°ä¸€ä¸ªä»¥ packageName ä¸ºåç§°çš„ TypeScript æ–‡ä»¶ã€‚</p>\n <figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    name!: <span class=\"built_in\">string</span>;</span><br><span class=\"line\">    age!: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">    friendList!: <span class=\"built_in\">Array</span>&lt;Person&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h1 id=\"ç¼ºé™·\">ç¼ºé™·<a title=\"#ç¼ºé™·\" href=\"#ç¼ºé™·\"></a></h1>\n<p>ç›®å‰çš„å®ç°æ–¹æ¡ˆæœ‰ä¸ªç¼ºé™·ï¼Œæ— æ³•å¤„ç† class çš„èŒƒå‹å‚æ•°ï¼Œç±»ä¼¼äº</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Page</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> index;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> size;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;T&gt; data;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>åªä¼šç”Ÿæˆ</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> Page &#123;</span><br><span class=\"line\">    index!: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">    size!: <span class=\"built_in\">number</span>;</span><br><span class=\"line\">    data!: <span class=\"built_in\">Array</span>&lt;T&gt;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Update: 2020/03/10</p>\n<p>å¯ä»¥é€šè¿‡ toGenericString æ–¹æ³•è·å–åŒ…å«èŒƒå‹å‚æ•°çš„ç±»å</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">clazz.toGenericString()</span><br><span class=\"line\"><span class=\"comment\">// sample: public class com.demo.model.page&lt;T&gt; &#123;&#125;</span></span><br></pre></td></tr></table></figure>","next":{"title":"Types and Methods of Interviews","link":"2021/03/02/Types-and-Methods-of-Interviews"},"plink":"https://syaki.github.io/2021/03/09/Generate-TypeScript-Interface-from-Java-Class/","toc":[{"id":"å…·ä½“æ€è·¯","title":"å…·ä½“æ€è·¯","index":"1"},{"id":"ç¼ºé™·","title":"ç¼ºé™·","index":"2"}],"copyright":{"author":"Syaki","link":"<a href=\"https://syaki.github.io/2021/03/09/Generate-TypeScript-Interface-from-Java-Class/\" title=\"Generate TypeScript Interface from Java Class\">https://syaki.github.io/2021/03/09/Generate-TypeScript-Interface-from-Java-Class/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)"}}